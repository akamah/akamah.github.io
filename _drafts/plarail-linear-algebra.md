---
layout: math
title:  "プラレール線型代数 (1)"
---

この記事は[夏合宿](http://blog.cybozu.io/entry/2017/08/30/080000)における @akamah の成果を寒くなった頃にまとめたものです．


## 概要
本記事では，プラレールを線型代数的な視点から眺めることによって，
レイアウトの理解，特に曲線レールに対する解釈を試みます．

## レールのベクトル
プラレールには様々なレールがありますが，ここでは直線レールと曲線レールについてのみ考えます．
直線レールの長さを1とすると，曲線レールは半径が長さ1の円周の8分の1の円弧です．

線型代数的な解釈ということで，*レールの持つベクトル*というものを考えてみます．
これはレールの片方を原点として，もう片方へ向かうベクトルとします．

（2. 図，あからさまな平面に縦横にレールが置いてある）

さっそくベクトルの合成を考えます．
レールの持つベクトルを合成するときは，実際のレールに必要な「ちゃんと向きが合っている」という条件を無視することにします．
すなわち，位置さえ正確に合っていればレールをつないで伸ばせる，と都合よく考えます．
この仮定はレールをベクトルとして考えるためのやや人為的なもので，
例えば以下のような連結もベクトルとして考える場合はちょっと許してしまおうということです [^jmitani]．

（3. 図，やばい連結）

さてさて，曲線レールのベクトルも描いてみましょう．すると不思議なこと（？）が起こります．

（4. 図）

原点から伸びた先の点はどういった座標になるでしょうか？計算してみます．

（5. 図，円を描いて中心との線とか補助線をピッと引いてみる）

$$ (x, y) = (1 - 1 / \sqrt{2}, 1 / \sqrt{2}) $$

平方根が出てきました．でも平方根ってちょっとめんどくさいですね．
もうすこし分かりやすく曲線レールの持つベクトルを表せないでしょうか．

## 曲線レール
ところで，単位円の中心から周への距離は等しく長さ1であり，曲線レールは8分の1の円弧です．
そこで，端っこを無理やりくっつけることで，
次のように**2つの直線の連結**だと捉えることもできます．

（6. 図）

すると，曲線レールのベクトルは，**タテまたはヨコ方向**と**ななめ方向**の長さ1のベクトルを連結したものと言えます．
すなわち，ベクトルとして考えることによって曲線レールを直線2つだと捉えることができるようになりました．

## レールのベクトル表現
すると直線レールおよび曲線レールのベクトルをまとめて表す方法がひとつ思いつきます．
タテヨコななめ方向のベクトルを**整数倍**して足し合わせてベクトル空間のようなものを作る方法です (注 [^vecspace])．

まず，$$ \boldsymbol{x} $$ と $$ \boldsymbol{y} $$をxy平面の標準基底とします．
そして，以下のように基底ベクトルを取ります．

$$
\begin{align}
\boldsymbol{a} &= \boldsymbol{x} \\
\boldsymbol{b} &= \frac{\boldsymbol{x} + \boldsymbol{y}}{\sqrt{2}} \\
\boldsymbol{c} &= \boldsymbol{y} \\
\boldsymbol{b} &= \frac{-\boldsymbol{x} + \boldsymbol{y}}{\sqrt{2}} \\
\end{align}
$$

そしてこれらの4つの基底ベクトルの**整数**線型結合でレール上の座標系を表します．

(7. 図，a, b, c, d)

こうすると，例えば横に伸びる直線レールのベクトルはx軸方向に長さ1のレールなので， $$(a, b, c, d) = (1, 0, 0, 0) $$ と,
原点から南（y軸の負の方向）に向かって置いた直線レールのベクトルは $$(a, b, c, d) = (0, 0, -1, 0)$$ と表されます．

（以後，ベクトルは単に数字を4つ並べて書くものとします）

問題の曲線レールですが，原点からy軸方向に沿って置いた場合のベクトルは $$(1, 0, 0, 1)$$ となります．
これは，右方向に長さ1，左上方向に長さ1の成分を持ったベクトル（つまり $$\boldsymbol{a} + \boldsymbol{d}$$ ）です．

（8. 図）

## れいの法則
ベクトル表現を用いて *れいの法則* [^lay]と呼ばれる法則を確認してみようと思います．
れいの法則とは，以下の2通りのレールが同じ地点にたどり着くという法則です．

（9. 図）

まず左側から確認します．6本のレールのベクトルを下から順に足し合わせると，こうなります．

$$
\begin{align}
& (0, 0, 1, 0) +
(0, 0, 1, 0) +
(1, 0, 0, 1) +
(0, 0, 1, -1) +
(0, 1, -1, 0) +
(0, 1, -1, 0) \\
= \ & (1, 2, 1, 0)
\end{align}
$$

続いて右側はこうなります．

$$
\begin{align}
& (1, 0, 0, 1) +
(0, 1, 0, 0) +
(0, 1, 0, 0) +
(0, 0, 1, -1) \\
= \ & (1, 2, 1, 0)
\end{align}
$$

2つのレールのベクトルが一致しました．やったね！

この計算では律儀にすべてのレールのベクトルを足して計算していましたが，
現実のよく扱うレイアウトではななめ方向はそこまで多く出てこなく（たぶん），
縦横方向はわりと合わせやすいため，
ななめ方向の成分だけをカウントすることにすれば暗算も簡単です．

このように，ベクトル表現を使わずにきっちり計算していたならば，
$$ 1 / \sqrt{2} $$がたくさん出てきて大変になっていたところを，
曲線レールはななめ方向の成分を持つ，
という風にベクトル表現で考えるとちょっと楽になることがあります．

---


[^jmitani]: 補足しますと，[三谷先生の結果](https://twitter.com/jmitani/status/864846261517656064) より，レールのはじっこの位置を変えずに向きを変えることはできるため，方向についてはひとまず考えなくてもよいことになります．
[^lay]: 原典が見当たりませんでしたが，こちらの議論で確認しました： [プラレールの組み合わせの法則議論](https://togetter.com/li/1070425)
[^vecspace]: 整数は体ではないので，厳密にはベクトル空間とは言えませんので，ベクトル空間のようなものと言い表しました．2次元平面に基底が4つあるのは係数が整数であるゆえです．
