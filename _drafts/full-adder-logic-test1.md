---
layout: post
title:  "プラレール全加算器構築テスト (1)"
---

あけましておめでとうございます，今年も楽しくプラレールで計算していきます！

この記事では，昨年の12月30日に実施したプラレール全加算器の構築テストについてお知らせいたします．

# テスト風景
こちらが今回製作したプラレール全加算器 ver.1.1 の全景です．

![プラレール全加算器][whole]

面積は約2.0m × 3.5m，高さは最大8段重ねとなり，かなり大きくて複雑なレイアウトになりました．

また，3つの電車が全加算器の3つの入力をそれぞれ読みとるため，**3並列で動作します**．

ちなみに全加算器とは，簡単にいうとゼロかイチを取る入力が3つあり，
それらの和を2進数の2bitで出力する論理回路素子です
（くわしくは [Wikipedia](https://ja.wikipedia.org/wiki/%E5%8A%A0%E7%AE%97%E5%99%A8#%E5%85%A8%E5%8A%A0%E7%AE%97%E5%99%A8)を参照ください）．

入力部分は見やすいように，ひな壇のようにずらして配置しました．
入出力は下の図のように対応しています．

![入出力][io]

A, B, Cが3つの入力，X, Sがそれぞれ2出力の上の桁と下の桁です．
黄緑色の線路がある方向に分岐レールのポイントが向いていれば1，そうでなければ0と解釈します．

# 設計のエラッタ
構築が完了し，さっそくテストランをしたところ，誤りを発見しました．
A = 1, B = 0, C = 1という入力で，出力が X = 0, S = 0と誤って出力されてしまいました
（本来は X = 1, S = 0のはずでした）．

![真理値表][whiteboard]

調べてみると，どうやら設計にミスがあったようです．
回路の下図に示す部分では，上の線路が下の線路に合流すべきだったのですが，
そのまま上の線路をたどっていってしまったようです．

![問題の箇所][eratta]

むむむ，どうにか修正できないでしょうか．構築にかなり時間を使ってしまい，
結構焦っていたのですが，しばらく考えると妙案が浮かびました．

![修正版][uturn]

Uターンレールです．なかなか使いどころの難しいこのレールを使って，
こんな感じで上の線路を下に合流させて解決しました
（後で気付いたのですが，かなり焦っていたようで，この写真ではUターンレールの組み方を間違えてます）．

しかし，微妙に隣の坂レールとぶつかっていたり，橋脚の数がすこし足りずミニ橋脚で代用したりと，いくつかの問題が発覚しました．
そのため念には念をということで，今年2月の[OSC 2018 Tokyo/Spring][osc]までに，再度全加算器のテストを行うことにしました．

# 謝辞
先日，[プラレール全加算器の部品の寄付をお願いしたところ]({% post_url 2017-11-03-plarail-linear-algebra %})，
たくさんの方々からレールをご提供いただきました．
おかげさまで，プラレール全加算器のテストができ，本番である[OSC 2018 Tokyo/Spring][osc]での全加算器の展示が実現できそうです．
レールをご提供いただいたみなさまに，心から感謝いたします！


<!---
sed -e's#.*#[&]: {{ "/assets/full-adder-logic-test1/&.jpg" | absolute_url }}#'
 --->

[osc]: https://www.ospn.jp/osc2018-spring/

[whole]: {{ "/assets/full-adder-logic-test1/whole.jpg" | absolute_url }}
[io]: {{ "/assets/full-adder-logic-test1/io.jpg" | absolute_url }}
[whiteboard]: {{ "/assets/full-adder-logic-test1/whiteboard.jpg" | absolute_url }}
[eratta]: {{ "/assets/full-adder-logic-test1/eratta.jpg" | absolute_url }}
[uturn]: {{ "/assets/full-adder-logic-test1/uturn.jpg" | absolute_url }}

